---
title: "ç¬¬10å›ï¼šFalcoã®ç™ºå±•ç³» - ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¨æœªæ¥"
---

# Falcoã®ç™ºå±•ç³» - ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¨æœªæ¥

9å›ã«æ¸¡ã£ã¦Falcoã®åŸºç¤ã‹ã‚‰æœ¬ç•ªé‹ç”¨ã¾ã§å­¦ã‚“ã§ãã¾ã—ãŸã€‚æœ€çµ‚ç« ã§ã¯ã€**Falcoã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚’ä¿¯ç°**ã—ã€ä»–ã®ãƒ„ãƒ¼ãƒ«ã¨ã®çµ„ã¿åˆã‚ã›æ–¹ã€ãã—ã¦ä»Šå¾Œã®å±•æœ›ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

Falcoã¯å˜ä½“ã§ã‚‚å¼·åŠ›ã§ã™ãŒã€OPA Gatekeeperã€Kyvernoã€Tetragonãªã©ã®ä»–ã®ãƒ„ãƒ¼ãƒ«ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€**å¤šå±¤é˜²å¾¡ï¼ˆDefense in Depthï¼‰**ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

## ã“ã®ç« ã§å­¦ã¶ã“ã¨

- Admission Controllerã¨Runtime Securityã®é–¢ä¿‚æ€§
- OPA Gatekeeper / Kyvernoã¨ã®ä½¿ã„åˆ†ã‘ã¨çµ±åˆ
- Tetragon / Traceeãªã©ã®é¡ä¼¼ãƒ„ãƒ¼ãƒ«ã¨ã®æ¯”è¼ƒ
- FalcoCTLã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ«ç®¡ç†ã®åŠ¹ç‡åŒ–
- Falco Pluginsã«ã‚ˆã‚‹æ‹¡å¼µæ€§
- Sysdig Secureï¼ˆå•†ç”¨ç‰ˆï¼‰ã¨ã®é•ã„
- CNAPPã«ãŠã‘ã‚‹Falcoã®ä½ç½®ã¥ã‘
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨Falcoã®æœªæ¥

---

## Admission Controller vs Runtime Security

### ãã‚Œãã‚Œã®å½¹å‰²

Kubernetesã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¯ã€**è¤‡æ•°ã®é˜²å¾¡å±¤**ãŒå¿…è¦ã§ã™ã€‚

| | Admission Controller | Runtime Security |
|-------------|----------------------|------------------|
| **ä»£è¡¨ãƒ„ãƒ¼ãƒ«** | OPA Gatekeeper, Kyverno | Falco, Tetragon |
| **æ¤œçŸ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚°** | ãƒ‡ãƒ—ãƒ­ã‚¤å‰ï¼ˆkubectl applyæ™‚ï¼‰ | å®Ÿè¡Œæ™‚ï¼ˆã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•å¾Œï¼‰ |
| **æ¤œçŸ¥å¯¾è±¡** | ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®å†…å®¹ | å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹ã®å‹•ä½œ |
| **å¼·ã¿** | äº‹å‰é˜²å¾¡ã€ãƒãƒªã‚·ãƒ¼é•åã‚’ãƒ–ãƒ­ãƒƒã‚¯ | äº‹å¾Œæ¤œçŸ¥ã€æ”»æ’ƒã®å®Ÿæ…‹æŠŠæ¡ |
| **å¼±ã¿** | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®å‹•ä½œã¯è¦‹ãˆãªã„ | ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªä½“ã¯é˜²ã’ãªã„ |
| **èª¤æ¤œçŸ¥ã®å½±éŸ¿** | ãƒ‡ãƒ—ãƒ­ã‚¤å¤±æ•—ï¼ˆæ¥­å‹™åœæ­¢ï¼‰ | ã‚¢ãƒ©ãƒ¼ãƒˆç™ºç«ï¼ˆèª¿æŸ»è² è·ï¼‰ |

### é˜²å¾¡å±¤ã®è€ƒãˆæ–¹ï¼ˆDefense in Depthï¼‰

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯å¤šå±¤é˜²å¾¡ãŒåŸºæœ¬**ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆãƒ“ãƒ«ãƒ‰æ™‚ï¼‰               â”‚
â”‚  ãƒ„ãƒ¼ãƒ«: Trivy, Grype, Snyk                         â”‚
â”‚  ç›®çš„: æ—¢çŸ¥è„†å¼±æ€§ã®æ¤œå‡º                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Admission Controlï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ï¼‰           â”‚
â”‚  ãƒ„ãƒ¼ãƒ«: OPA Gatekeeper, Kyverno                    â”‚
â”‚  ç›®çš„: ãƒãƒªã‚·ãƒ¼é•åã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é˜²æ­¢                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Runtime Securityï¼ˆå®Ÿè¡Œæ™‚ï¼‰                â”‚
â”‚  ãƒ„ãƒ¼ãƒ«: Falco, Tetragon                            â”‚
â”‚  ç›®çš„: ç•°å¸¸ãªå‹•ä½œã®æ¤œçŸ¥                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Network Policyï¼ˆé€šä¿¡åˆ¶å¾¡ï¼‰                â”‚
â”‚  ãƒ„ãƒ¼ãƒ«: Cilium, Calico                             â”‚
â”‚  ç›®çš„: ä¸æ­£ãªé€šä¿¡ã®é®æ–­                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸¡æ–¹å¿…è¦ãªç†ç”±

**å…·ä½“ä¾‹ï¼šç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠã®é˜²å¾¡**

#### ã‚·ãƒŠãƒªã‚ª1: Admission Controllerã®ã¿

```yaml
# OPA Gatekeeper ãƒãƒªã‚·ãƒ¼
apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sPSPPrivilegedContainer
metadata:
  name: deny-privileged-containers
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
```

**çµæœ**ï¼š
- âœ… `kubectl apply`æ™‚ã«ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ–ãƒ­ãƒƒã‚¯
- âŒ æ—¢ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ã®ã‚³ãƒ³ãƒ†ãƒŠãŒæ¨©é™æ˜‡æ ¼ã—ã¦ã‚‚æ¤œçŸ¥ã§ããªã„
- âŒ Daemonsetãªã©ä¾‹å¤–ã‚’ä½œã‚‹ã¨ã€ãã®éš™ã‚’çªã‹ã‚Œã‚‹å¯èƒ½æ€§

#### ã‚·ãƒŠãƒªã‚ª2: Runtime Securityã®ã¿

```yaml
# Falco ãƒ«ãƒ¼ãƒ«
- rule: Launch Privileged Container
  condition: container_started and container.privileged=true
  output: Privileged container detected
  priority: CRITICAL
```

**çµæœ**ï¼š
- âŒ ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªä½“ã¯è¨±å¯ã•ã‚Œã¦ã—ã¾ã†
- âœ… èµ·å‹•å¾Œã«å³åº§ã«ã‚¢ãƒ©ãƒ¼ãƒˆ
- âœ… æ”»æ’ƒè€…ãŒå¾Œã‹ã‚‰æ¨©é™æ˜‡æ ¼ã—ã¦ã‚‚æ¤œçŸ¥

#### ã‚·ãƒŠãƒªã‚ª3: ä¸¡æ–¹ã®çµ„ã¿åˆã‚ã›ï¼ˆæ¨å¥¨ï¼‰

```
Admission Controller: æ­£è¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãƒãƒªã‚·ãƒ¼é•åã‚’ãƒ–ãƒ­ãƒƒã‚¯
         +
Runtime Security: æ”»æ’ƒè€…ã«ã‚ˆã‚‹ä¸æ­£ãªå‹•ä½œã‚’æ¤œçŸ¥
         =
å¼·å›ºãªå¤šå±¤é˜²å¾¡
```

**å®Ÿè·µçš„ãªä½¿ã„åˆ†ã‘**ï¼š

| ã‚±ãƒ¼ã‚¹ | Admission | Runtime | ç†ç”± |
|--------|-----------|---------|------|
| é–‹ç™ºç’°å¢ƒã®ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠ | è¨±å¯ | ç›£è¦– | é–‹ç™ºã®æŸ”è»Ÿæ€§ + ç•°å¸¸æ¤œçŸ¥ |
| æœ¬ç•ªç’°å¢ƒã®ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠ | æ‹’å¦ï¼ˆä¾‹å¤–ã‚ã‚Šï¼‰ | å³é‡ç›£è¦– | æœ€å°æ¨©é™ã®åŸå‰‡ |
| CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ã‚·ã‚§ãƒ«å®Ÿè¡Œ | è¨±å¯ | ä¾‹å¤–è¨­å®š | æ­£è¦ã®å‹•ä½œã‚’å¦¨ã’ãªã„ |
| æœ¬ç•ªWebã‚µãƒ¼ãƒãƒ¼ã®ã‚·ã‚§ãƒ«å®Ÿè¡Œ | - | CRITICAL | æ”»æ’ƒã®å¯èƒ½æ€§ãŒé«˜ã„ |

---

## OPA Gatekeeper

### Gatekeeperã¨ã¯

**OPAï¼ˆOpen Policy Agentï¼‰Gatekeeper**ã¯ã€Kubernetes Admission Controllerã¨ã—ã¦å‹•ä½œã™ã‚‹ãƒãƒªã‚·ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚

**ä¸»ãªæ©Ÿèƒ½**ï¼š
- Regoã§è¨˜è¿°ã•ã‚ŒãŸãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹å®£è¨€çš„ãªåˆ¶å¾¡
- ConstraintTemplateã«ã‚ˆã‚‹å†åˆ©ç”¨å¯èƒ½ãªãƒãƒªã‚·ãƒ¼å®šç¾©
- Dry-runæ©Ÿèƒ½ã«ã‚ˆã‚‹æ®µéšçš„å°å…¥
- Auditæ©Ÿèƒ½ã«ã‚ˆã‚‹æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã®ç›£æŸ»

### Falcoã¨ã®çµ„ã¿åˆã‚ã›

**çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          kubectl apply                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OPA Gatekeeper (Admission Controller)           â”‚
â”‚  - ãƒãƒªã‚·ãƒ¼é•åã‚’ãƒ–ãƒ­ãƒƒã‚¯                          â”‚
â”‚  - è¨±å¯ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ âœ… è¨±å¯
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod èµ·å‹•                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Falco (Runtime Security)                        â”‚
â”‚  - å®Ÿè¡Œæ™‚ã®ç•°å¸¸å‹•ä½œã‚’æ¤œçŸ¥                          â”‚
â”‚  - æ”»æ’ƒã®è©¦ã¿ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®Ÿè£…ä¾‹1: ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠã®åˆ¶å¾¡

**Gatekeeperå´ï¼ˆAdmission Controlï¼‰**ï¼š

```yaml
# constraint-template.yaml
apiVersion: templates.gatekeeper.sh/v1beta1
kind: ConstraintTemplate
metadata:
  name: k8spsprivilegedcontainer
spec:
  crd:
    spec:
      names:
        kind: K8sPSPPrivilegedContainer
  targets:
    - target: admission.k8s.gatekeeper.sh
      rego: |
        package k8spspprivileged

        violation[{"msg": msg}] {
          container := input.review.object.spec.containers[_]
          container.securityContext.privileged
          msg := sprintf("Privileged container is not allowed: %v", [container.name])
        }

---
# constraint.yaml
apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sPSPPrivilegedContainer
metadata:
  name: deny-privileged-containers
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
    excludedNamespaces: ["kube-system", "falco"]  # ã‚·ã‚¹ãƒ†ãƒ ç³»ã¯é™¤å¤–
```

**Falcoå´ï¼ˆRuntime Detectionï¼‰**ï¼š

```yaml
# custom-rules.yaml
- rule: Launch Privileged Container
  desc: ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã‚’æ¤œçŸ¥ï¼ˆGatekeeperã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ãŸå¯èƒ½æ€§ï¼‰
  condition: >
    container_started and
    container.privileged=true and
    not k8s.ns.name in (kube-system, falco)
  output: >
    ALERT: Privileged container launched (bypassed admission control?)
    (pod=%k8s.pod.name ns=%k8s.ns.name image=%container.image.repository)
  priority: CRITICAL
  tags: [admission_bypass, privilege_escalation]
```

**ç›¸ä¹—åŠ¹æœ**ï¼š
- Gatekeeper: æ­£è¦ãƒ•ãƒ­ãƒ¼ã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ãƒ–ãƒ­ãƒƒã‚¯
- Falco: Gatekeeperã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹æ”»æ’ƒã‚’æ¤œçŸ¥

#### å®Ÿè£…ä¾‹2: ãƒ›ã‚¹ãƒˆãƒ‘ã‚¹ãƒã‚¦ãƒ³ãƒˆã®åˆ¶å¾¡

**Gatekeeperå´**ï¼š

```yaml
apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sPSPHostFilesystem
metadata:
  name: restrict-host-path
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
  parameters:
    allowedHostPaths:
      - pathPrefix: "/var/log"
        readOnly: true
```

**Falcoå´**ï¼š

```yaml
- rule: Sensitive Host Path Mounted
  desc: æ©Ÿå¯†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸ
  condition: >
    container_started and
    fd.name startswith "/host/etc" or
    fd.name startswith "/host/root"
  output: >
    Sensitive host path mounted
    (pod=%k8s.pod.name path=%fd.name)
  priority: CRITICAL
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

| ãƒãƒªã‚·ãƒ¼ | Gatekeeper | Falco | çµ„ã¿åˆã‚ã›ã®åŠ¹æœ |
|---------|------------|-------|-----------------|
| **ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠç¦æ­¢** | ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ãƒ–ãƒ­ãƒƒã‚¯ | å®Ÿè¡Œæ™‚ã«æ¤œçŸ¥ | ãƒã‚¤ãƒ‘ã‚¹æ”»æ’ƒã®æ¤œçŸ¥ |
| **ãƒ›ã‚¹ãƒˆãƒ‘ã‚¹ãƒã‚¦ãƒ³ãƒˆåˆ¶é™** | è¨±å¯ãƒªã‚¹ãƒˆã§åˆ¶å¾¡ | ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥ | è¨­å®šãƒŸã‚¹ã®è£œå®Œ |
| **ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¸ã‚¹ãƒˆãƒªåˆ¶é™** | æ‰¿èªæ¸ˆã¿ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®ã¿ | ä¸å¯©ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã®å®Ÿè¡Œæ¤œçŸ¥ | ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æ”»æ’ƒå¯¾ç­– |
| **ãƒªã‚½ãƒ¼ã‚¹ã‚¯ã‚©ãƒ¼ã‚¿** | CPU/ãƒ¡ãƒ¢ãƒªä¸Šé™è¨­å®š | ç•°å¸¸ãªãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»æ¤œçŸ¥ | ã‚¯ãƒªãƒ—ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°å¯¾ç­– |

---

## Kyverno

### Kyvernoã¨ã¯

**Kyverno**ã¯ã€Kuberneteså°‚ç”¨ã®ãƒãƒªã‚·ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã§ã€**Regoã§ã¯ãªãé€šå¸¸ã®YAMLã§è¨˜è¿°**ã§ãã‚‹ç‚¹ãŒç‰¹å¾´ã§ã™ã€‚

**ä¸»ãªæ©Ÿèƒ½**ï¼š
- YAMLãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼è¨˜è¿°ï¼ˆå­¦ç¿’ã‚³ã‚¹ãƒˆãŒä½ã„ï¼‰
- Mutateæ©Ÿèƒ½ï¼ˆãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ä¿®æ­£ï¼‰
- Generateæ©Ÿèƒ½ï¼ˆãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ç”Ÿæˆï¼‰
- Verify Imagesæ©Ÿèƒ½ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ç½²åæ¤œè¨¼ï¼‰

### Gatekeeperã¨ã®é•ã„

| | OPA Gatekeeper | Kyverno |
|-------------|----------------|---------|
| **ãƒãƒªã‚·ãƒ¼è¨€èª** | Regoï¼ˆå°‚ç”¨è¨€èªï¼‰ | YAML |
| **å­¦ç¿’æ›²ç·š** | æ€¥ï¼ˆRegoã®å­¦ç¿’ãŒå¿…è¦ï¼‰ | ç·©ï¼ˆYAMLã®çŸ¥è­˜ã®ã¿ï¼‰ |
| **æ±ç”¨æ€§** | é«˜ï¼ˆK8sä»¥å¤–ã«ã‚‚ä½¿ãˆã‚‹ï¼‰ | ä½ï¼ˆK8så°‚ç”¨ï¼‰ |
| **Mutateæ©Ÿèƒ½** | ãªã— | ã‚ã‚Šï¼ˆãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ä¿®æ­£ï¼‰ |
| **Generateæ©Ÿèƒ½** | ãªã— | ã‚ã‚Šï¼ˆNetworkPolicyãªã©è‡ªå‹•ç”Ÿæˆï¼‰ |
| **ã‚¤ãƒ¡ãƒ¼ã‚¸æ¤œè¨¼** | ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ãŒå¿…è¦ | çµ„ã¿è¾¼ã¿æ©Ÿèƒ½ |
| **æˆç†Ÿåº¦** | é«˜ï¼ˆCNCF Graduatedï¼‰ | ä¸­ï¼ˆCNCF Incubatingï¼‰ |

### Falcoã¨ã®çµ„ã¿åˆã‚ã›

#### å®Ÿè£…ä¾‹1: ã‚¤ãƒ¡ãƒ¼ã‚¸ç½²åæ¤œè¨¼ + Runtimeç›£è¦–

**Kyvernoå´ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸æ¤œè¨¼ï¼‰**ï¼š

```yaml
# verify-images.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: verify-image-signature
spec:
  validationFailureAction: Enforce
  rules:
    - name: verify-signature
      match:
        any:
        - resources:
            kinds:
              - Pod
      verifyImages:
      - imageReferences:
        - "myregistry.io/*"
        attestors:
        - count: 1
          entries:
          - keys:
              publicKeys: |-
                -----BEGIN PUBLIC KEY-----
                MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE...
                -----END PUBLIC KEY-----
```

**Falcoå´ï¼ˆRuntimeæ¤œè¨¼ï¼‰**ï¼š

```yaml
- rule: Unsigned Image Running
  desc: ç½²åã•ã‚Œã¦ã„ãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ï¼ˆKyvernoãƒã‚¤ãƒ‘ã‚¹ï¼‰
  condition: >
    container_started and
    not container.image.repository startswith "myregistry.io/"
  output: >
    Unsigned image detected (bypass Kyverno?)
    (pod=%k8s.pod.name image=%container.image.repository)
  priority: CRITICAL
```

#### å®Ÿè£…ä¾‹2: NetworkPolicyã®è‡ªå‹•ç”Ÿæˆ + é€šä¿¡ç›£è¦–

**Kyvernoå´ï¼ˆNetworkPolicyè‡ªå‹•ç”Ÿæˆï¼‰**ï¼š

```yaml
# generate-network-policy.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: generate-network-policy
spec:
  rules:
    - name: default-deny-ingress
      match:
        any:
        - resources:
            kinds:
              - Namespace
      generate:
        kind: NetworkPolicy
        name: default-deny-ingress
        namespace: "{{request.object.metadata.name}}"
        data:
          spec:
            podSelector: {}
            policyTypes:
              - Ingress
```

**Falcoå´ï¼ˆé€šä¿¡ç›£è¦–ï¼‰**ï¼š

```yaml
- rule: Unexpected Outbound Connection
  desc: NetworkPolicyã§åˆ¶é™ã•ã‚Œã¦ã„ãªã„ã¯ãšã®é€šä¿¡ã‚’æ¤œçŸ¥
  condition: >
    outbound and
    not fd.sip in (allowed_destinations) and
    k8s.ns.name != kube-system
  output: >
    Unexpected outbound connection
    (pod=%k8s.pod.name dest=%fd.sip:%fd.dport)
  priority: WARNING
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

**KyvernoãŒå¾—æ„ãªã“ã¨**ï¼š
- ã‚¤ãƒ¡ãƒ¼ã‚¸ç½²åã®è‡ªå‹•æ¤œè¨¼ï¼ˆCosignçµ±åˆï¼‰
- ãƒ©ãƒ™ãƒ«ã‚„ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®è‡ªå‹•è¿½åŠ 
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆNetworkPolicyã®è‡ªå‹•ç”Ÿæˆ
- ResourceQuotaã®è‡ªå‹•è¨­å®š

**FalcoãŒå¾—æ„ãªã“ã¨**ï¼š
- ãƒãƒªã‚·ãƒ¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ãŸæ”»æ’ƒã®æ¤œçŸ¥
- ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ç•°å¸¸ãªå‹•ä½œæ¤œçŸ¥
- ã‚³ãƒ³ãƒ†ãƒŠã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®æ¤œçŸ¥

**çµ±åˆã«ã‚ˆã‚‹ä¾¡å€¤**ï¼š

```
Kyverno: "æ­£ã—ã„è¨­å®š" ã‚’å¼·åˆ¶
    +
Falco: "æ­£ã—ããªã„å‹•ä½œ" ã‚’æ¤œçŸ¥
    =
å®Œå…¨ãªé˜²å¾¡å±¤
```

---

## Tetragon / Tracee ã¨ã®æ¯”è¼ƒ

### Tetragon

**Tetragon**ã¯ã€Ciliumãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã§eBPFå°‚ç”¨ã§ã™ã€‚

| é …ç›® | Falco | Tetragon |
|------|-------|----------|
| **é–‹ç™ºå…ƒ** | Sysdig â†’ CNCF | Isovalent (Cilium) |
| **ãƒ‰ãƒ©ã‚¤ãƒãƒ¼** | ã‚«ãƒ¼ãƒãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« / eBPF | eBPFå°‚ç”¨ |
| **ãƒ«ãƒ¼ãƒ«è¨˜è¿°** | YAML | YAMLï¼ˆã‚ˆã‚Šè©³ç´°ãªåˆ¶å¾¡ï¼‰ |
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–** | åŸºæœ¬çš„ | å¼·åŠ›ï¼ˆCiliumã¨çµ±åˆï¼‰ |
| **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹** | è‰¯å¥½ | éå¸¸ã«è‰¯å¥½ï¼ˆeBPFæœ€é©åŒ–ï¼‰ |
| **ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ** | æˆç†Ÿï¼ˆCNCF Graduatedï¼‰ | æˆé•·ä¸­ï¼ˆCNCF Sandboxï¼‰ |
| **Enforcement** | ãªã—ï¼ˆæ¤œçŸ¥ã®ã¿ï¼‰ | ã‚ã‚Šï¼ˆãƒ—ãƒ­ã‚»ã‚¹Killå¯èƒ½ï¼‰ |

**Tetragonã®å¼·ã¿**ï¼š

```yaml
# Tetragonã®ä¾‹ï¼šãƒ—ãƒ­ã‚»ã‚¹å®Ÿè¡Œã‚’ãƒ–ãƒ­ãƒƒã‚¯
apiVersion: cilium.io/v1alpha1
kind: TracingPolicy
metadata:
  name: block-shell-execution
spec:
  kprobes:
  - call: "security_bprm_check"
    syscall: false
    args:
    - index: 0
      type: "linux_binprm"
    selectors:
    - matchBinaries:
      - operator: "In"
        values:
        - "/bin/bash"
        - "/bin/sh"
      matchActions:
      - action: Sigkill  # ãƒ—ãƒ­ã‚»ã‚¹ã‚’å¼·åˆ¶çµ‚äº†
```

**Falcoã¨ã®é•ã„**ï¼š
- Tetragon: **Preventionï¼ˆé˜²æ­¢ï¼‰** ãŒå¯èƒ½
- Falco: **Detectionï¼ˆæ¤œçŸ¥ï¼‰** ã«ç‰¹åŒ–

**é¸æŠã®æŒ‡é‡**ï¼š
- **Falco**: æ¤œçŸ¥ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆã«ç‰¹åŒ–ã€ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒæˆç†Ÿ
- **Tetragon**: Ciliumã‚’ä½¿ç”¨ä¸­ã§ã€EnforcementãŒå¿…è¦ãªå ´åˆ

### Tracee

**Tracee**ã¯ã€Aqua SecurityãŒé–‹ç™ºã™ã‚‹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

| é …ç›® | Falco | Tracee |
|------|-------|--------|
| **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹** | æœ¬ç•ªé‹ç”¨ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ç©¶ãƒ»ãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯ |
| **ãƒ«ãƒ¼ãƒ«æ•°** | è±Šå¯Œï¼ˆæœ¬ç•ªå‘ã‘ï¼‰ | é™å®šçš„ï¼ˆç ”ç©¶å‘ã‘ï¼‰ |
| **å‡ºåŠ›å½¢å¼** | JSON/ãƒ†ã‚­ã‚¹ãƒˆ | è©³ç´°ãªã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚° |
| **ä½¿ã„ã‚„ã™ã•** | é«˜ | ä¸­ï¼ˆã‚ˆã‚ŠæŠ€è¡“çš„ï¼‰ |

**TraceeãŒå¾—æ„ãªã“ã¨**ï¼š
- è©³ç´°ãªãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯åˆ†æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ç©¶
- eBPFã®ãƒ‡ãƒãƒƒã‚°

**é¸æŠã®æŒ‡é‡**ï¼š
- **Falco**: æœ¬ç•ªç’°å¢ƒã§ã®é‹ç”¨
- **Tracee**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ç©¶ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆèª¿æŸ»

---

## FalcoCTL

### FalcoCTLã¨ã¯

**FalcoCTLï¼ˆFalco Controlï¼‰**ã¯ã€Falcoãƒ«ãƒ¼ãƒ«ã®ç®¡ç†ã‚’åŠ¹ç‡åŒ–ã™ã‚‹CLIãƒ„ãƒ¼ãƒ«ã§ã™ï¼ˆ2022å¹´ç™»å ´ï¼‰ã€‚

**ä¸»ãªæ©Ÿèƒ½**ï¼š
- ãƒ«ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»æ›´æ–°
- OCIï¼ˆOpen Container Initiativeï¼‰ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã§ã®ãƒ«ãƒ¼ãƒ«é…å¸ƒ
- ãƒ«ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### ä¸»è¦æ©Ÿèƒ½

#### 1. ãƒ«ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# å…¬å¼ãƒ«ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
falcoctl index add falcosecurity https://falcosecurity.github.io/falcoctl/index.yaml
falcoctl artifact install falco-rules

# ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
falcoctl artifact install mycompany/custom-rules:1.2.0
```

#### 2. ãƒ«ãƒ¼ãƒ«ã®æ›´æ–°

```bash
# åˆ©ç”¨å¯èƒ½ãªæ›´æ–°ã®ç¢ºèª
falcoctl artifact search falco-rules

# æ›´æ–°ã®é©ç”¨
falcoctl artifact update
```

#### 3. ãƒ«ãƒ¼ãƒ«ã®é…å¸ƒï¼ˆOCI Registryï¼‰

```yaml
# .falcoctl.yaml
registry:
  auth:
    basic:
      - registry: myregistry.io
        username: ${REGISTRY_USER}
        password: ${REGISTRY_PASSWORD}
```

```bash
# ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’OCIãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ãƒ—ãƒƒã‚·ãƒ¥
falcoctl registry push \
  myregistry.io/security/falco-rules:1.0.0 \
  --type rulesfile \
  --config custom-rules.yaml

# ä»–ã®ã‚¯ãƒ©ã‚¹ã‚¿ã§ãƒ—ãƒ«
falcoctl registry pull myregistry.io/security/falco-rules:1.0.0
```

### ãƒ«ãƒ¼ãƒ«ç®¡ç†ã®åŠ¹ç‡åŒ–

**GitOpsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. é–‹ç™ºè€…ãŒãƒ«ãƒ¼ãƒ«ã‚’GitHubã«Push             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. CI/CDã§falcoctlã‚’ä½¿ã£ã¦OCIãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«  â”‚
â”‚     ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆè‡ªå‹•ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Kubernetes JobãŒFalcoCTLã§å®šæœŸçš„ã«     â”‚
â”‚     æœ€æ–°ãƒ«ãƒ¼ãƒ«ã‚’ãƒ—ãƒ«                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Falco DaemonSetãŒæ–°ã—ã„ãƒ«ãƒ¼ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CronJobè¨­å®šä¾‹**ï¼š

```yaml
# rule-updater-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: falco-rule-updater
  namespace: falco
spec:
  schedule: "0 2 * * *"  # æ¯æ—¥2æ™‚ã«å®Ÿè¡Œ
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: falcoctl
            image: falcosecurity/falcoctl:latest
            command:
            - /bin/sh
            - -c
            - |
              falcoctl artifact update
              kubectl rollout restart daemonset falco -n falco
          restartPolicy: OnFailure
```

---

## Falco Plugins

### Pluginã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦

Falco 0.31.0ï¼ˆ2022å¹´ï¼‰ã‹ã‚‰ã€**Pluginã‚·ã‚¹ãƒ†ãƒ **ãŒå°å…¥ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ä»¥å¤–ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã«ã‚‚å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

**Pluginã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Falco Engine                         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                    â”‚
     â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Syscall     â”‚    â”‚  Plugin Framework       â”‚
â”‚ (libscap)   â”‚    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚          â”‚
                      â–¼          â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ K8s Auditâ”‚  â”‚CloudTrailâ”‚
              â”‚ Plugin   â”‚  â”‚ Plugin   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»è¦ãªPlugin

#### 1. K8s Audit Plugin

Kubernetes Audit Logã‚’ç›´æ¥Falcoã§å‡¦ç†ã—ã¾ã™ï¼ˆç¬¬7å›ã§è§£èª¬ï¼‰ã€‚

```yaml
# falco.yaml
plugins:
  - name: k8saudit
    library_path: libk8saudit.so
    init_config: ""
    open_params: "http://:9765/k8s-audit"

load_plugins: [k8saudit]
```

#### 2. CloudTrail Plugin

AWS CloudTrailã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–ã—ã¾ã™ã€‚

```yaml
# falco.yaml
plugins:
  - name: cloudtrail
    library_path: libcloudtrail.so
    init_config:
      aws_region: us-west-2
      sqs_queue: falco-cloudtrail-queue

load_plugins: [cloudtrail]
```

**æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«ä¾‹**ï¼š

```yaml
- rule: AWS Root Account Usage
  desc: AWSãƒ«ãƒ¼ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½¿ç”¨ã•ã‚ŒãŸ
  condition: >
    cloudtrail.user = "root"
  output: >
    ROOT account used (user=%cloudtrail.user action=%cloudtrail.action)
  priority: CRITICAL
```

#### 3. GitHub Plugin

GitHubã®Audit Logã‚’ç›£è¦–ã—ã¾ã™ã€‚

```yaml
# falco.yaml
plugins:
  - name: github
    library_path: libgithub.so
    init_config:
      organization: mycompany
      token: ${GITHUB_TOKEN}

load_plugins: [github]
```

**æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«ä¾‹**ï¼š

```yaml
- rule: Sensitive Repo Access
  desc: æ©Ÿå¯†ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œçŸ¥
  condition: >
    github.repo = "mycompany/secrets" and
    github.action in (clone, pull)
  output: >
    Sensitive repo accessed (user=%github.user repo=%github.repo)
  priority: WARNING
```

### ã‚«ã‚¹ã‚¿ãƒ Pluginã®ä½œæˆ

**Plugin SDK**ã‚’ä½¿ã£ã¦ã‚«ã‚¹ã‚¿ãƒ Pluginã‚’ä½œæˆã§ãã¾ã™ã€‚

```go
// custom-plugin.go
package main

import (
    "github.com/falcosecurity/plugin-sdk-go/pkg/sdk"
)

type MyPlugin struct{}

func (p *MyPlugin) Info() string {
    return `{"name":"myplugin","version":"0.1.0"}`
}

func (p *MyPlugin) Open(params string) (sdk.Instance, error) {
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã¸ã®æ¥ç¶šå‡¦ç†
    return &MyInstance{}, nil
}

func (i *MyInstance) NextBatch() ([]sdk.EventReader, error) {
    // ã‚¤ãƒ™ãƒ³ãƒˆã®å–å¾—å‡¦ç†
    return events, nil
}
```

**ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ä¾‹**ï¼š
- ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ ã®Audit Logé€£æº
- SaaSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆOktaã€Salesforceãªã©ï¼‰ã®ç›£è¦–
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç›£è¦–

---

## Policy as Code

### GitOpsã¨ã®çµ±åˆ

Falcoãƒ«ãƒ¼ãƒ«ã‚’**Infrastructure as Code**ã¨ã—ã¦ç®¡ç†ã—ã¾ã™ã€‚

**ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆä¾‹**ï¼š

```
security-policies/
â”œâ”€â”€ falco/
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â”œâ”€â”€ default-rules.yaml        # å…¨ç’°å¢ƒå…±é€š
â”‚   â”‚   â”œâ”€â”€ pci-dss-rules.yaml        # ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
â”‚   â”‚   â””â”€â”€ kustomization.yaml
â”‚   â”œâ”€â”€ overlays/
â”‚   â”‚   â”œâ”€â”€ development/
â”‚   â”‚   â”‚   â”œâ”€â”€ exceptions.yaml       # é–‹ç™ºç’°å¢ƒã®ä¾‹å¤–
â”‚   â”‚   â”‚   â””â”€â”€ kustomization.yaml
â”‚   â”‚   â”œâ”€â”€ staging/
â”‚   â”‚   â”‚   â”œâ”€â”€ exceptions.yaml
â”‚   â”‚   â”‚   â””â”€â”€ kustomization.yaml
â”‚   â”‚   â””â”€â”€ production/
â”‚   â”‚       â”œâ”€â”€ exceptions.yaml       # æœ¬ç•ªç’°å¢ƒã®ä¾‹å¤–
â”‚   â”‚       â”œâ”€â”€ custom-rules.yaml     # æœ¬ç•ªå°‚ç”¨ãƒ«ãƒ¼ãƒ«
â”‚   â”‚       â””â”€â”€ kustomization.yaml
â”‚   â””â”€â”€ tests/
â”‚       â”œâ”€â”€ test_rules.yaml           # ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
â”‚       â””â”€â”€ run_tests.sh
â”œâ”€â”€ gatekeeper/
â”‚   â””â”€â”€ policies/
â””â”€â”€ kyverno/
    â””â”€â”€ policies/
```

### ãƒãƒªã‚·ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

**Semantic Versioning**ã‚’ä½¿ã£ãŸãƒ«ãƒ¼ãƒ«ç®¡ç†ï¼š

```yaml
# falco-rules-metadata.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: falco-rules-metadata
  namespace: falco
  annotations:
    version: "2.5.0"  # Semantic Versioning
    changelog: |
      v2.5.0:
        - Added: PCI-DSS compliance rules
        - Fixed: False positive in crypto miner detection
      v2.4.0:
        - Added: Container escape detection improvements
data:
  version: "2.5.0"
  compatibility: ">=falco-0.37.0"
```

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã®ãƒãƒªã‚·ãƒ¼ãƒ†ã‚¹ãƒˆ

**GitHub Actionsä¾‹**ï¼š

```yaml
# .github/workflows/falco-rules-test.yaml
name: Falco Rules Test

on:
  pull_request:
    paths:
      - 'falco/**'

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install Falco
        run: |
          curl -s https://falco.org/script/install | bash

      - name: Validate Rules Syntax
        run: |
          falco --dry-run \
            -r falco/base/default-rules.yaml \
            -r falco/overlays/production/custom-rules.yaml

      - name: Run Rule Tests
        run: |
          # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
          ./falco/tests/run_tests.sh

      - name: Policy Coverage Report
        run: |
          # ã©ã®CIS BenchmarkãŒã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
          ./scripts/coverage-report.sh
```

**ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹**ï¼š

```bash
# tests/run_tests.sh
#!/bin/bash

# ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ç‰¹æ¨©ã‚³ãƒ³ãƒ†ãƒŠæ¤œçŸ¥
echo "Test 1: Privileged Container Detection"
kubectl run test-privileged --image=alpine --restart=Never \
  --overrides='{"spec":{"containers":[{"name":"test","image":"alpine","securityContext":{"privileged":true}}]}}'

sleep 5

# Falcoãƒ­ã‚°ã‚’ç¢ºèª
if kubectl logs -n falco -l app=falco | grep "Privileged container"; then
  echo "âœ… Test 1 Passed"
else
  echo "âŒ Test 1 Failed"
  exit 1
fi

kubectl delete pod test-privileged
```

---

## Sysdig Secureï¼ˆå•†ç”¨ç‰ˆï¼‰

### ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ç‰ˆã¨ã®é•ã„

| æ©Ÿèƒ½ | OSS Falco | Sysdig Secure |
|------|-----------|---------------|
| **Runtime Detection** | âœ… | âœ… |
| **ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«** | âœ… | âœ… |
| **Web UI** | Falcosidekick UIï¼ˆåŸºæœ¬çš„ï¼‰ | é«˜æ©Ÿèƒ½ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ |
| **ãƒãƒ«ãƒã‚¯ãƒ©ã‚¹ã‚¿ç®¡ç†** | æ‰‹å‹•è¨­å®šãŒå¿…è¦ | çµ±åˆç®¡ç†UI |
| **AIã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥** | âŒ | âœ… Machine Learning |
| **è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹** | âŒ | âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–° |
| **ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ** | æ‰‹å‹•ä½œæˆ | âœ… è‡ªå‹•ç”Ÿæˆï¼ˆPCI-DSS/SOC2ãªã©ï¼‰ |
| **ãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯æ©Ÿèƒ½** | åŸºæœ¬çš„ | âœ… è©³ç´°ãªãƒ—ãƒ­ã‚»ã‚¹ãƒ„ãƒªãƒ¼åˆ†æ |
| **Vulnerability Management** | åˆ¥é€”ãƒ„ãƒ¼ãƒ«å¿…è¦ | âœ… çµ±åˆæ©Ÿèƒ½ |
| **ã‚µãƒãƒ¼ãƒˆ** | ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ | 24/7å•†ç”¨ã‚µãƒãƒ¼ãƒˆ |
| **ä¾¡æ ¼** | ç„¡æ–™ | $$$ï¼ˆãƒãƒ¼ãƒ‰èª²é‡‘ï¼‰ |

### Sysdig Secureã®è¿½åŠ æ©Ÿèƒ½

#### 1. Machine Learningç•°å¸¸æ¤œçŸ¥

```
é€šå¸¸ã®Falco: ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®æ¤œçŸ¥
    â†“
Sysdig Secure: ML + ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰

ä¾‹ï¼š
- é€šå¸¸ã¨ç•°ãªã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³
- ç•°å¸¸ãªãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»
- ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‹ã‚‰ã®é€¸è„±
```

#### 2. çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Sysdig Secure Dashboard               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Runtime  â”‚ â”‚Vulnera-  â”‚ â”‚Complianceâ”‚     â”‚
â”‚ â”‚ Security â”‚ â”‚ bility   â”‚ â”‚ Report   â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Alert Timeline                             â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                 â”‚
â”‚                                             â”‚
â”‚  Top Threats                                â”‚
â”‚  1. Cryptocurrency Mining  (5 incidents)    â”‚
â”‚  2. Privilege Escalation  (2 incidents)     â”‚
â”‚  3. Container Escape      (1 incident)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. ãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯æ©Ÿèƒ½

```bash
# OSS Falcoã®å ´åˆ
kubectl logs -n falco falco-xxxxx | grep "crypto"

# Sysdig Secureã®å ´åˆ
- ãƒ—ãƒ­ã‚»ã‚¹ãƒ„ãƒªãƒ¼å…¨ä½“ã®å¯è¦–åŒ–
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šå±¥æ­´
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹å±¥æ­´
- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³åˆ†æ
- ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã®å°ã˜è¾¼ã‚
```

### ã©ã¡ã‚‰ã‚’é¸ã¶ã¹ãã‹

| ã‚±ãƒ¼ã‚¹ | æ¨å¥¨ | ç†ç”± |
|--------|------|------|
| **ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼ˆ<50ãƒãƒ¼ãƒ‰ï¼‰** | OSS Falco | ã‚³ã‚¹ãƒˆãƒ¡ãƒªãƒƒãƒˆã€ååˆ†ãªæ©Ÿèƒ½ |
| **ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºï¼ˆ>200ãƒãƒ¼ãƒ‰ï¼‰** | Sysdig Secure | çµ±åˆç®¡ç†ã€MLã€ã‚µãƒãƒ¼ãƒˆ |
| **ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¿…é ˆ** | Sysdig Secure | è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |
| **DIYç²¾ç¥ãŒå¼·ã„ãƒãƒ¼ãƒ ** | OSS Falco | ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã®é«˜ã• |
| **å°‚ä»»SREãŒã„ãªã„** | Sysdig Secure | é‹ç”¨è² è·ã®è»½æ¸› |

### ç§»è¡Œãƒ‘ã‚¹

```
Phase 1: OSS Falcoã§å°å…¥
  - å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‹
  - åŸºæœ¬çš„ãªæ¤œçŸ¥ã‚’ç¢ºç«‹
  â†“
Phase 2: é‹ç”¨ãŒå®‰å®š
  - ãƒã‚¤ã‚ºå‰Šæ¸›ãŒå®Œäº†
  - ãƒãƒ¼ãƒ å†…ã«ãƒã‚¦ãƒã‚¦è“„ç©
  â†“
Phase 3: ã‚¹ã‚±ãƒ¼ãƒ«èª²é¡Œã«ç›´é¢
  - ãƒãƒ«ãƒã‚¯ãƒ©ã‚¹ã‚¿ç®¡ç†ãŒç…©é›‘
  - ã‚¢ãƒ©ãƒ¼ãƒˆåˆ†æã«æ™‚é–“ãŒã‹ã‹ã‚‹
  â†“
Phase 4: Sysdig Secureã¸ç§»è¡Œ
  - ãƒ‡ãƒ¼ã‚¿ã¯äº’æ›æ€§ã‚ã‚Š
  - ãƒ«ãƒ¼ãƒ«ã‚‚æµç”¨å¯èƒ½
```

---

## CNAPPã¨Falco

### CNAPPã¨ã¯

**CNAPPï¼ˆCloud Native Application Protection Platformï¼‰**ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’ä¿è­·ã™ã‚‹çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

**CNAPPã®5ã¤ã®æŸ±**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. CSPM (Cloud Security Posture Mgmt)      â”‚
â”‚     ã‚¯ãƒ©ã‚¦ãƒ‰è¨­å®šã®ç›£è¦–                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. CWPP (Cloud Workload Protection)        â”‚
â”‚     ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ä¿è­· â† **Falcoã¯ã“ã“**    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. CIEM (Cloud Infra Entitlement Mgmt)     â”‚
â”‚     ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ç®¡ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Vulnerability Management                â”‚
â”‚     è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Threat Detection                        â”‚
â”‚     è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Falcoã®CNAPPã«ãŠã‘ã‚‹ä½ç½®ã¥ã‘

Falcoã¯**CWPPï¼ˆCloud Workload Protectionï¼‰**ã®ä¸­æ ¸ã‚’æ‹…ã„ã¾ã™ã€‚

**çµ±åˆçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚¿ãƒƒã‚¯ä¾‹**ï¼š

| å±¤ | ãƒ„ãƒ¼ãƒ« | Falcoã¨ã®é–¢ä¿‚ |
|----|--------|---------------|
| **CSPM** | Prowler, ScoutSuite | è¨­å®šãƒŸã‚¹ã‚’Falcoãƒ«ãƒ¼ãƒ«ã«åæ˜  |
| **CWPPï¼ˆRuntimeï¼‰** | **Falco** | ä¸­æ ¸ |
| **CIEM** | AWS IAM Access Analyzer | éå‰°æ¨©é™ã‚’Falcoã§ç›£è¦– |
| **Vulnerability** | Trivy, Grype | è„†å¼±æ€§æƒ…å ±ã‚’Falcoãƒ«ãƒ¼ãƒ«ã«æ´»ç”¨ |
| **Threat Intel** | AlienVault OTX | IoCï¼ˆIndicators of Compromiseï¼‰ã‚’Falcoãƒ«ãƒ¼ãƒ«ã«å¤‰æ› |

**çµ±åˆä¾‹ï¼šTrivyã¨Falcoã®é€£æº**

```yaml
# 1. Trivyã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³
trivy image myapp:latest --format json > vulnerabilities.json

# 2. é«˜ãƒªã‚¹ã‚¯è„†å¼±æ€§ã‚’æŒã¤ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç›£è¦–ã™ã‚‹Falcoãƒ«ãƒ¼ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆ
- rule: High Risk CVE Image Running
  desc: é«˜ãƒªã‚¹ã‚¯CVEã‚’å«ã‚€ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå®Ÿè¡Œä¸­
  condition: >
    container_started and
    container.image.repository in (vulnerable_images)
  output: High risk CVE detected (image=%container.image.repository)
  priority: CRITICAL
```

### çµ±åˆçš„ãªã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

**ç†æƒ³çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Central Security Platform              â”‚
â”‚  (SIEM: Splunk / Elasticsearch / DataDog)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚
         â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
â”‚ CSPM Alerts  â”‚ â”‚ Falco   â”‚ â”‚ Trivy Scan â”‚
â”‚ (Prowler)    â”‚ â”‚ Runtime â”‚ â”‚ Results    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 

### CNCF Falcoã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£

**ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®è¦æ¨¡**ï¼š
- **GitHub Stars**: 8,000+
- **ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚¿ãƒ¼**: 200+å
- **æœˆé–“ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**: 1,000ä¸‡+
- **Slack**: 5,000+ãƒ¡ãƒ³ãƒãƒ¼

**å‚åŠ æ–¹æ³•**ï¼š
- [Falco Slack](https://kubernetes.slack.com/messages/falco)ï¼ˆ#falcoãƒãƒ£ãƒ³ãƒãƒ«ï¼‰
- [GitHub Discussions](https://github.com/falcosecurity/falco/discussions)
- [æœˆä¾‹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°](https://github.com/falcosecurity/community)ï¼ˆæ¯æœˆç¬¬3æ°´æ›œæ—¥ï¼‰

### ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³æ–¹æ³•

#### 1. ãƒ«ãƒ¼ãƒ«ã®å…±æœ‰

```bash
# è‡ªä½œãƒ«ãƒ¼ãƒ«ã‚’ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«è²¢çŒ®
git clone https://github.com/falcosecurity/rules
cd rules
# ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ 
git add custom-rules/my-rule.yaml
git commit -m "Add: Detection rule for cryptocurrency mining"
git push origin my-feature-branch
# Pull Requestä½œæˆ
```

#### 2. Pluginé–‹ç™º

```bash
# Plugin SDKã‚’ä½¿ç”¨
git clone https://github.com/falcosecurity/plugin-sdk-go
# ã‚«ã‚¹ã‚¿ãƒ Pluginã‚’é–‹ç™º
# ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
```

#### 3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ”¹å–„

```bash
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒã‚¸ãƒˆãƒª
git clone https://github.com/falcosecurity/falco-website
# ç¿»è¨³ã‚„æ”¹å–„ã‚’ææ¡ˆ
```

### ä»Šå¾Œã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

**Falco 2025å¹´ä»¥é™ã®ãƒ“ã‚¸ãƒ§ãƒ³**ï¼š

#### 1. ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ

```
ç¾åœ¨: Linuxå°‚ç”¨
  â†“
å°†æ¥: Windows / macOS / Cloud Functionså¯¾å¿œ
```

#### 2. AI/MLçµ±åˆ

```
- ç•°å¸¸æ¤œçŸ¥ã®è‡ªå‹•åŒ–
- ãƒ«ãƒ¼ãƒ«ã®è‡ªå‹•ç”Ÿæˆ
- False Positiveã®è‡ªå‹•å‰Šæ¸›
```

#### 3. Enforcementæ©Ÿèƒ½

```
ç¾åœ¨: Detectionï¼ˆæ¤œçŸ¥ï¼‰ã®ã¿
  â†“
å°†æ¥: Preventionï¼ˆé˜²æ­¢ï¼‰æ©Ÿèƒ½ã®è¿½åŠ æ¤œè¨
  ï¼ˆTetragonã¨ã®çµ±åˆï¼Ÿï¼‰
```

#### 4. ã‚ˆã‚Šå¼·åŠ›ãªPlugin Ecosystem

```
- SaaSé€£æºã®æ‹¡å……ï¼ˆOkta, Salesforce, Microsoft 365ï¼‰
- IoT/Edgeå¯¾å¿œ
- ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚µãƒãƒ¼ãƒˆ
```

---

## é€£è¼‰ã‚’çµ‚ãˆã¦

### å­¦ã‚“ã ã“ã¨ã®æŒ¯ã‚Šè¿”ã‚Š

å…¨10å›ã‚’é€šã˜ã¦ã€Falcoã®åŸºç¤ã‹ã‚‰å®Ÿè·µã¾ã§å­¦ã³ã¾ã—ãŸï¼š

| å› | ã‚¿ã‚¤ãƒˆãƒ« | å­¦ã‚“ã ã“ã¨ |
|----|----------|-----------|
| ç¬¬1å› | Falcoã¨ã¯ä½•ã‹ | Runtime Securityã®æœ¬è³ªã€Wiresharkã¨Falcoã®å“²å­¦ |
| ç¬¬2å› | åŸºæœ¬å‹•ä½œã®ç†è§£ | Syscallã®ä»•çµ„ã¿ã€ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®é¸æŠ |
| ç¬¬3å› | ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å®Ÿè·µ | Docker/Minikube/Kindã§ã®å‹•ä½œç¢ºèª |
| ç¬¬4å› | ãƒ«ãƒ¼ãƒ«ä½œæˆï¼ˆåˆç´šï¼‰ | condition/output/priorityã®åŸºæœ¬ |
| ç¬¬5å› | ãƒ«ãƒ¼ãƒ«ä½œæˆï¼ˆä¸­ç´šï¼‰ | ä¾‹å¤–ç®¡ç†ã€æœ¬ç•ªç’°å¢ƒå‘ã‘ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚° |
| ç¬¬6å› | å¯è¦–åŒ– | Falcosidekickã€Slack/PagerDutyé€£æº |
| ç¬¬7å› | K8s Audité€£æº | APIå±¤ã¨Syscallå±¤ã®çµ±åˆç›£è¦– |
| ç¬¬8å› | CI/CDçµ±åˆ | DevSecOpsã€GitOpsã€Policy as Code |
| ç¬¬9å› | æœ¬ç•ªé‹ç”¨ | ãƒªã‚½ãƒ¼ã‚¹è¨­è¨ˆã€ãƒã‚¤ã‚ºå‰Šæ¸›ã€SREé€£æº |
| ç¬¬10å› | ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ  | ä»–ãƒ„ãƒ¼ãƒ«ã¨ã®çµ„ã¿åˆã‚ã›ã€æœªæ¥ã®å±•æœ› |

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**å®Ÿè·µç·¨**ï¼š
1. ã¾ãšé–‹ç™ºç’°å¢ƒã§Falcoã‚’å‹•ã‹ã—ã¦ã¿ã‚‹ï¼ˆç¬¬3å›ï¼‰
2. è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆï¼ˆç¬¬4-5å›ï¼‰
3. å¯è¦–åŒ–ã¨ã‚¢ãƒ©ãƒ¼ãƒˆé€£æºã‚’è¨­å®šï¼ˆç¬¬6å›ï¼‰
4. ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§è¦³å¯Ÿãƒ¢ãƒ¼ãƒ‰é‹ç”¨ï¼ˆç¬¬9å›ï¼‰
5. æœ¬ç•ªç’°å¢ƒã¸ã®æ®µéšçš„å±•é–‹ï¼ˆç¬¬9å›ï¼‰

**ç™ºå±•ç·¨**ï¼š
1. OPA Gatekeeperã¾ãŸã¯Kyvernoã¨ã®çµ±åˆ
2. FalcoCTLã«ã‚ˆã‚‹è‡ªå‹•åŒ–
3. ã‚«ã‚¹ã‚¿ãƒ Pluginã®é–‹ç™º
4. ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

### ã•ã‚‰ãªã‚‹å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

#### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Falco Official Docs](https://falco.org/docs/)
- [Falco Rules Repository](https://github.com/falcosecurity/rules)
- [Falco Plugin SDK](https://github.com/falcosecurity/plugin-sdk-go)

#### ãƒãƒ³ã‚ºã‚ªãƒ³
- [Falco Katacoda Scenarios](https://www.katacoda.com/falco)
- [Security Playground](https://github.com/falcosecurity/evolution)

#### ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
- [Falco Slack](https://kubernetes.slack.com/messages/falco)
- [Falco Blog](https://falco.org/blog/)
- [Sysdig Blog](https://sysdig.com/blog/)

#### ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãƒˆãƒ¼ã‚¯
- KubeCon + CloudNativeConï¼ˆFalcoãƒˆãƒ©ãƒƒã‚¯ï¼‰
- Cloud Security Summit
- CNCF Webinars

---

## ã¾ã¨ã‚

ã“ã®é€£è¼‰ã§ã¯ã€Falcoã«ã‚ˆã‚‹Kubernetesãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å®Ÿè£…ã‚’ã€åŸºç¤ã‹ã‚‰å®Ÿè·µã¾ã§å­¦ã³ã¾ã—ãŸã€‚

**Falcoã®æœ¬è³ª**ï¼š
- **ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ç›£è¦–**: Syscallãƒ¬ãƒ™ãƒ«ã§æ”¹ã–ã‚“ä¸å¯èƒ½ãªæ¤œçŸ¥
- **ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹**: å®£è¨€çš„ã§ç†è§£ã—ã‚„ã™ã„æ¤œçŸ¥ãƒ­ã‚¸ãƒƒã‚¯
- **ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ **: ä»–ãƒ„ãƒ¼ãƒ«ã¨ã®çµ„ã¿åˆã‚ã›ã§å¤šå±¤é˜²å¾¡

**æˆåŠŸã®ãƒã‚¤ãƒ³ãƒˆ**ï¼š
1. **æ®µéšçš„å°å…¥**: ä¸€æ°—ã«æœ¬ç•ªå±•é–‹ã›ãšã€è¦³å¯Ÿâ†’èª¿æ•´â†’å±•é–‹
2. **ãƒã‚¤ã‚ºå‰Šæ¸›**: ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œã‚’é˜²ããŸã‚ã®ä¾‹å¤–ç®¡ç†
3. **ãƒãƒ¼ãƒ é€£æº**: SREã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€é–‹ç™ºã®å”åŠ›
4. **ç¶™ç¶šçš„æ”¹å–„**: ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦çµ‚ã‚ã‚Šã§ã¯ãªãã€é‹ç”¨ã—ãªãŒã‚‰æœ€é©åŒ–

**å¤šå±¤é˜²å¾¡ã®è€ƒãˆæ–¹**ï¼š

```
ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆTrivyï¼‰
    +
Admission Controlï¼ˆGatekeeper/Kyvernoï¼‰
    +
Runtime Securityï¼ˆFalcoï¼‰
    +
Network Policyï¼ˆCiliumï¼‰
    =
å¼·å›ºãªKubernetesã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
```

Falcoã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®é‡è¦ãªä¸€éƒ¨ã§ã™ã€‚ã“ã®é€£è¼‰ã§å­¦ã‚“ã çŸ¥è­˜ã‚’æ´»ã‹ã—ã¦ã€çš†ã•ã‚“ã®ç’°å¢ƒã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Šã«å½¹ç«‹ã¦ã¦ã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚

**Happy Securing with Falco! ğŸ›¡ï¸**

---

## å‚è€ƒè³‡æ–™

### Falcoå…¬å¼
- [Falco Official Website](https://falco.org/)
- [Falco GitHub](https://github.com/falcosecurity/falco)
- [Falco Documentation](https://falco.org/docs/)
- [CNCF Falco Project Page](https://www.cncf.io/projects/falco/)

### é–¢é€£ãƒ„ãƒ¼ãƒ«
- [OPA Gatekeeper](https://open-policy-agent.github.io/gatekeeper/)
- [Kyverno](https://kyverno.io/)
- [Tetragon](https://tetragon.io/)
- [Tracee](https://github.com/aquasecurity/tracee)

### å•†ç”¨ç‰ˆ
- [Sysdig Secure](https://sysdig.com/products/secure/)

### ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
- [Falco Slack](https://kubernetes.slack.com/messages/falco)
- [Falco Mailing List](https://lists.cncf.io/g/cncf-falco-dev)
- [Falco Community Meetings](https://github.com/falcosecurity/community)

### å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹
- [Falco Blog](https://falco.org/blog/)
- [Sysdig Blog - Falco Series](https://sysdig.com/blog/tag/falco/)
- [KubeCon Talks on Falco](https://www.youtube.com/results?search_query=kubecon+falco)
