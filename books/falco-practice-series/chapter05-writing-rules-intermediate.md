---
title: "第5回：Falcoのルールを書く（中級編）- 実運用に寄せる"
---

# Falcoのルールを書く（中級編）- 実運用に寄せる

## この章で学ぶこと

- namespace / labelsを使ったスコープ限定
- workloadごとに例外（exception）を作る
- ノイジーなルールを抑える綺麗な例外の作り方
- 変更の影響範囲テスト

---

## スコープの限定

### namespaceによる限定

```yaml
# 執筆予定：namespace限定のルール例
```

### labelsによる限定

```yaml
# 執筆予定：label限定のルール例
```

### 複数条件の組み合わせ

:::message
**執筆予定内容**
- 検知対象を適切に絞り込む方法
- 本番環境での実例
:::

## 例外（exception）の作り方

### 例外の基本概念

### workloadごとの例外

```yaml
# 執筆予定：CI/CDジョブのroot実行を許可する例
```

### 時間帯による例外

### ユーザーによる例外

:::message
**執筆予定内容**
- 例外を綺麗に管理する方法
- 例外が増えすぎないための設計
:::

## 実例1：CI/CDジョブだけroot実行を許す

```yaml
# 執筆予定：具体的なルール
```

### ユースケース

### 実装のポイント

### テスト方法

## 実例2：kubectl execされたらアラート

```yaml
# 執筆予定：kubectl exec検知のルール
```

### ユースケース

### 実装のポイント

### Slack通知との連携

## ノイズ削減戦略

### ベースラインの作成

### 段階的なルール適用

### アラート疲れを防ぐ

:::message
**執筆予定内容**
- 実運用でのノイズ削減テクニック
- チームとの調整方法
:::

## 変更の影響範囲テスト

### テスト環境での検証

### カナリアデプロイメント

### ロールバック戦略

:::message
**執筆予定内容**
- ルール変更時の安全な手順
- 影響範囲の見積もり方
:::

## まとめ

この章では、実運用に耐えるFalcoルールの書き方を学びました。

次章では、Falcosidekickを使った可視化について学びます。

---

## 参考資料

- [Falco Rules Best Practices](https://falco.org/docs/rules/best-practices/)
- [Exception Handling](https://falco.org/docs/rules/exceptions/)
